# Технический стек и использованные технологии

## Общий обзор архитектуры

Sber Split App построен на основе современной клиент-серверной архитектуры с разделением на независимые frontend и backend компоненты, которые взаимодействуют через REST API.

## Frontend

### Основные технологии

- **React 19.0.0**: Использован последний стабильный релиз React для создания пользовательского интерфейса с компонентным подходом. Это обеспечивает высокую производительность и переиспользуемость кода.

- **TypeScript**: Статическая типизация для улучшения качества кода, предотвращения ошибок на этапе сборки и улучшения developer experience.

- **Vite 6.2.0**: Современный инструмент для быстрой сборки и разработки, значительно ускоряющий процесс разработки.

- **React Router 7.4.1**: Обеспечивает навигацию между различными страницами приложения без перезагрузки.

### Структура приложения

```
frontend/
├── src/
│   ├── components/     # Переиспользуемые компоненты
│   │   ├── header/     # Компоненты для шапки приложения
│   │   ├── ImageCropper/  # Компоненты для обрезки изображений
│   │   ├── MainButtons/   # Основные кнопки управления
│   │   └── receipt/    # Компоненты для работы с чеками
│   ├── pages/         # Компоненты страниц
│   │   ├── HomePage.jsx      # Главная страница
│   │   └── ReceiptPage.jsx   # Страница работы с чеком
│   ├── context/       # React контексты для управления состоянием
│   ├── hooks/         # Кастомные React-хуки
│   ├── services/      # Сервисы для работы с API
│   ├── utils/         # Вспомогательные функции
│   ├── styles/        # Общие стили
│   ├── types/         # TypeScript типы и интерфейсы
│   ├── assets/        # Статические ресурсы
│   ├── app.jsx        # Основной компонент приложения
│   └── index.jsx      # Точка входа в приложение
└── public/            # Статические файлы
```

### Используемые библиотеки и инструменты

- **react-image-crop 11.0.7**: Для интерактивной обрезки изображений чеков перед отправкой на обработку.

- **ESLint 9.21.0**: Для контроля качества кода и соблюдения стилистических правил.

- **CSS Modules**: Для изоляции стилей компонентов и предотвращения конфликтов имен классов.

## Backend

### Основные технологии

- **Node.js**: Серверная JavaScript-среда для создания высокопроизводительных и масштабируемых приложений.

- **Express 4.18.2**: Минималистичный веб-фреймворк для Node.js, обеспечивающий создание REST API.

### Структура серверной части

```
back/
├── server.js                # Основной файл сервера
├── testUtils.js             # Вспомогательные функции
├── uploads/                 # Директория для загружаемых изображений
└── processedReceipts/       # Директория с результатами обработки
```

### Используемые библиотеки и инструменты

- **Multer 1.4.5**: Middleware для обработки multipart/form-data, используется для загрузки изображений.

- **CORS 2.8.5**: Для настройки политики Cross-Origin Resource Sharing, позволяет frontend-приложению безопасно взаимодействовать с API.

- **Nodemon 3.0.1** (dev dependency): Для автоматической перезагрузки сервера при изменении кода в процессе разработки.

## Интеграция с AI

- **Google Gemini AI 2.0 Flash**: Используется для анализа и извлечения структурированных данных из изображений чеков.

- **Подход к обработке**: Система преобразует загруженное изображение в base64, формирует детализированный промпт с инструкциями по анализу чека и отправляет запрос к Gemini API через Netlify Function (serverless-функцию), которая выступает в качестве прокси для безопасного доступа к API.

## API интерфейсы

### Основные эндпоинты

1. **POST /upload**
   - Принимает изображение чека
   - Обрабатывает изображение с помощью Gemini AI
   - Возвращает структурированные данные о позициях и сумме чека

2. **GET /receipts/:id**
   - Получает информацию о ранее обработанном чеке по его ID

## Процесс разработки

- **Версионирование**: Git с использованием .gitignore для исключения node_modules и других временных файлов

- **Код-стиль**: Соблюдение современных практик React и Node.js разработки, использование ESLint для контроля качества кода

## Производительность и оптимизация

- **Оптимизация изображений**: Предварительная обрезка изображений для уменьшения объема передаваемых данных

- **Кэширование обработанных результатов**: Сохранение результатов анализа чеков в JSON-файлах для последующего использования

## Безопасность

- **Валидация входных данных**: Проверка загружаемых файлов на соответствие ожидаемым форматам

- **Безопасная работа с файловой системой**: Использование уникальных имен файлов для предотвращения перезаписи

- **CORS**: Настройка и ограничение доступа к API с разных источников

## Планы по развитию

1. **Добавление аутентификации пользователей** для персонализации опыта и сохранения истории чеков

2. **Интеграция с платежными системами** для упрощения процесса разделения счетов

3. **Улучшение алгоритмов распознавания чеков** с возможностью обучения на основе пользовательских корректировок

4. **Мобильное приложение** для более удобного использования в ресторанах и кафе 